str_replace("N", 0)
df %<>%
dplyr::mutate(correct = as.numeric(correct))
#renaming for better graphs
df$trial_type %<>%
str_replace("all", "All")%>%
str_replace("some", "Some")%>%
str_replace("none", "None")
df$selection_type %<>%
str_replace("all", "All")%>%
str_replace("some", "Some")%>%
str_replace("none", "None")
x <- unique(df$sub_id)
# Exclusions
df1 <-  subset(df, sub_id != "11716_14" & sub_id != "11316_2"
& sub_id != "121815_7" & sub_id != "1616_6"
& sub_id != "TM001" & sub_id != "TM003" & sub_id != "TM004" &
sub_id != "12416_9") #excluded due to consent issue, and low number of trials, and parental interference
df <- df1
# df %<>%
#   dplyr::filter(sub_id != "11716_14" & sub_id != "11316_2" & sub_id != "12016_1"
#                 & sub_id != "12016_2" & sub_id != "12016_4" & sub_id != "12016_8"
#                 & sub_id != "12016_9" & sub_id != "11016_5" & sub_id != "11716_10"
#                 & sub_id != "1616_3" & sub_id != "11016_12" & sub_id != "121815_5"
#                 & sub_id != "121815_6" & sub_id != "121815_7" & sub_id != "1616_7"
#                 & sub_id != "12216_12" & sub_id != "12116_5" & sub_id != "12216_8")%>% # for english < 75%
#   dplyr::filter(sub_id != "1616_6", na.rm = TRUE)%>%#broken iPad
#   dplyr::filter(sub_id != "1616_4", na.rm = TRUE)%>%
#   dplyr::filter(sub_id != "TM001" & sub_id != "TM002" & sub_id != "TM003" & sub_id != "TM004" & sub_id != "TM005" & sub_id != "TM006" & sub_id != "TM007", na.rm = TRUE) #just until tamara's data is complete
#
# df %<>%
#   dplyr::filter(sub_id != "NA")%>%
#   dplyr::filter(age != "NA")
# qplot(rt, data = df)
#There are some really crazy rts - exclude everything above 30s
df$clean.rt <- df$rt
df$clean.rt[df$rt > 15000] <- NA
mlog <- mean(log(df$clean.rt), na.rm=TRUE)
sdlog <- sd(log(df$clean.rt), na.rm=TRUE)
# qplot(clean.rt, data=df)
# qplot(log(clean.rt),
#       fill = log(clean.rt) > mlog + 3*sdlog | log(clean.rt) < mlog - 3*sdlog,
#       data = df)
df$clean.rt[log(df$clean.rt) > mlog + 3*sdlog |
log(df$clean.rt) < mlog - 3*sdlog] <- NA
#filter df to exclude NAs (RT cleaned)
df %<>%
filter(clean.rt != "NA")
num_subjects <- df %>%
select(sub_id)%>%
distinct()
num_trials <- df %>%
group_by(sub_id, agesplit)%>%
summarise(n = n())
View(num_trials)
num_kids <- df %>%
dplyr::select(sub_id, agesplit) %>%
dplyr:: distinct()%>%
dplyr::group_by(agesplit)%>%
dplyr::summarize(n=n())%>%
dplyr::mutate(total.n = sum(n))
View(num_kids)
ms <- df %>%
group_by(trial_type, agesplit)%>%
multi_boot_standard("correct", na.rm=TRUE)
ms$trial_type %<>%
str_replace("all", "All")%>%
str_replace("none", "None")%>%
str_replace("some", "Some")
quartz()
ggplot(data = ms,
aes(x=trial_type, y=mean, fill= agesplit)) +
geom_bar(stat="identity", position = position_dodge()) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .4,
show.legend = FALSE,
position=position_dodge(.9)) +
ylab("Proportion correct") +
xlab("Trial Type") +
theme_bw(base_size = 8) + theme(axis.title.x = element_text(size=8),
axis.title.y  = element_text(size=8)) +
scale_fill_solarized(name = "Age") + theme(legend.position=c(.8,.8)) + theme(legend.key.size=unit(.2, "cm")) + theme(legend.title=element_text(size=5)) + theme(legend.text=element_text(size=5))
View(num_kids)
trialtypes <- c("all", "some", "none")
df$resp1 <- df$resp %>%
str_replace("lower", "Incorrect")%>%
str_replace("upper", "Correct")
#for easier to read graph
df$resp1 <- factor(df$resp1, levels=c("Incorrect", "Correct"))
quartz()
ggplot(df, aes(x=q)) +
geom_density(aes(fill=resp1), alpha=0.3) +
facet_grid(agesplit ~ trial_type, scales = "free") +
theme_bw(base_size = 8) + theme(axis.title.x = element_text(size=8),
axis.title.y  = element_text(size=8)) +
scale_fill_solarized(name = "Response") +
xlab("Response time (s)") + ylab("Density of responses")
trialtypes = c("All", "Some", "None")
#create dataframe
sub.pars <- data.frame(Separation = numeric(),
Non.Decision = numeric(),
Bias = numeric(),
Drift = numeric(),
Trial.Type = character(),
SubID = character(),
Age = character())
sub.pars$Trial.Type <- as.character(sub.pars$Trial.Type)
sub.pars$SubID <- as.character(sub.pars$SubID)
sub.pars$Age <- as.character(sub.pars$Age)
temp.pars <- sub.pars
df$resp <- as.character(df$resp)
#this takes a while to run, but estimating parameters for each subject
#Note that this is with excluded reaction time data, but it's possible that we shouldn't be excluding any rts...
# df %<>%
#   dplyr::filter(q > 0, na.rm = TRUE)
subs <- unique(df$sub_id)
for (j in 1:length(subs)) {
sid <- as.character(subs[j])
for (i in 1:length(trialtypes)) {
print(paste("i =", i))
print(paste("j =" ,j))
ttype <- as.character(trialtypes[i])
dat <- as.data.frame(subset(df, trial_type == ttype & sub_id == sid))
opt <- optim(c(1, .1, .1, 1), wiener_deviance,
dat=dplyr::select(dat, c(q, resp)), method="Nelder-Mead")
pars <- c(opt$par, ttype, sid, dat$agesplit[1])
temp.pars[i,] <- pars
}
sub.pars <- rbind(temp.pars, sub.pars)
}
ggplot(sub.pars.ms, aes(x=Age, y=mean, color=Trial.Type)) +
geom_point(size = 2) + geom_linerange(aes(ymin = ci_lower, ymax = ci_upper)) +
facet_wrap(~Param, scales="free") + langcog::scale_color_solarized(guide_legend(title="Trial Type")) + ylab("Mean") + xlab("Age") + theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 7), axis.title.y = element_text(size=8), legend.title=element_text(size = 7), legend.text=element_text(size=6), axis.title.x = element_text(size=8), text = element_text(size = 8))
sub.pars$Separation <- as.numeric(sub.pars$Separation)
sub.pars$Non.Decision <- as.numeric(sub.pars$Non.Decision)
sub.pars$Bias <- as.numeric(sub.pars$Bias)
sub.pars$Drift <- as.numeric(sub.pars$Drift)
sub.pars.ms <- sub.pars %>%
gather(Param, Value, Separation:Drift) %>%
group_by(Age, Trial.Type, Param) %>%
multi_boot_standard("Value", na.rm = TRUE)
sub.pars.ms$Age %<>%
str_replace("1", "one")%>%
str_replace("2", "two")%>%
str_replace("3", "three")%>%
str_replace("4", "four")%>%
str_replace("5", "five")%>%
str_replace("one", "3-3.5 years") %>%
str_replace("two", "3.5-4 years")%>%
str_replace("three", "4-4.5 years")%>%
str_replace("four", "4.5-5 years")%>%
str_replace("five", "5-6.5 years")
#
ggplot(sub.pars.ms, aes(x=Age, y=mean, color=Trial.Type)) +
geom_point(size = 2) + geom_linerange(aes(ymin = ci_lower, ymax = ci_upper)) +
facet_wrap(~Param, scales="free") + langcog::scale_color_solarized(guide_legend(title="Trial Type")) + ylab("Mean") + xlab("Age") + theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 7), axis.title.y = element_text(size=8), legend.title=element_text(size = 7), legend.text=element_text(size=6), axis.title.x = element_text(size=8), text = element_text(size = 8))
ggplot(sub.pars.ms, aes(x=Age, y=mean, color=Trial.Type)) +
geom_point(size = 2) +
facet_wrap(~Param, scales="free") + langcog::scale_color_solarized(guide_legend(title="Trial Type")) + ylab("Mean") + xlab("Age") + theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 7), axis.title.y = element_text(size=8), legend.title=element_text(size = 7), legend.text=element_text(size=6), axis.title.x = element_text(size=8), text = element_text(size = 8)) + geom_smooth(aes(ymin = ci_lower, ymax = ci_upper), data=sub.pars.ms, stat="identity")
ggplot(sub.pars.ms, aes(x=Age, y=mean, color=Trial.Type)) +
geom_point(size = 2) +
facet_wrap(~Param, scales="free") + langcog::scale_color_solarized(guide_legend(title="Trial Type")) + ylab("Mean") + xlab("Age") + theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 7), axis.title.y = element_text(size=8), legend.title=element_text(size = 7), legend.text=element_text(size=6), axis.title.x = element_text(size=8), text = element_text(size = 8)) + geom_smooth(aes(ymin = ci_lower, ymax = ci_upper), data=sub.pars, stat="identity")
ggplot(sub.pars.ms, aes(x=Age, y=mean, color=Trial.Type)) +
geom_point(size = 2) +
facet_wrap(~Param, scales="free") + langcog::scale_color_solarized(guide_legend(title="Trial Type")) + ylab("Mean") + xlab("Age") + theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 7), axis.title.y = element_text(size=8), legend.title=element_text(size = 7), legend.text=element_text(size=6), axis.title.x = element_text(size=8), text = element_text(size = 8)) + geom_smooth()
ggplot(sub.pars.ms, aes(x=Age, y=mean, color=Trial.Type)) +
geom_point(size = 2) +
facet_wrap(~Param, scales="free") + langcog::scale_color_solarized(guide_legend(title="Trial Type")) + ylab("Mean") + xlab("Age") + theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 7), axis.title.y = element_text(size=8), legend.title=element_text(size = 7), legend.text=element_text(size=6), axis.title.x = element_text(size=8), text = element_text(size = 8)) + geom_smooth(method="lm")
head(sub.pars)
sub.params <- sub.pars %>%
spead(Trial.Type)
?spread
sub.params <- sub.pars %>%
spread(Trial.Type)
sub.params <- sub.pars %>%
spread(Trial.Type, sub_id)
head(sub.pars)
sub.params <- sub.pars %>%
spread(Trial.Type, SubID)
head(sub.params)
sub.params <- sub.pars %>%
gather(Param, Value, Separation:Drift) %>%
group_by(SubID, Trial.Type, Param)
head(sub.params)
head(sub.pars.ms)
View(sub.params)
sub.params <- sub.pars %>%
gather(Param, Value, Separation:Drift) %>%
group_by(SubID, Trial.Type, Param)%>%
multi_boot_standard("Value", na.rm =TRUE)
head(sub.params)
View(sub.params)
ggplot(sub.pars.ms, aes(x=Age, y=mean, color=Trial.Type)) +
geom_point(size = 2) +
facet_wrap(~Param, scales="free") + langcog::scale_color_solarized(guide_legend(title="Trial Type")) + ylab("Mean") + xlab("Age") + theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 7), axis.title.y = element_text(size=8), legend.title=element_text(size = 7), legend.text=element_text(size=6), axis.title.x = element_text(size=8), text = element_text(size = 8)) + geom_smooth(data = sub.pars, method="lm", se = FALSE)
quartz()
ggplot(sub.pars.ms, aes(x=Age, y=mean, color=Trial.Type)) +
geom_point(size = 2) + geom_linerange(aes(ymin = ci_lower, ymax = ci_upper)) +
facet_wrap(~Param, scales="free") + langcog::scale_color_solarized(guide_legend(title="Trial Type")) + ylab("Mean") + xlab("Age") + theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 7), axis.title.y = element_text(size=8), legend.title=element_text(size = 7), legend.text=element_text(size=6), axis.title.x = element_text(size=8), text = element_text(size = 8))
quartz()
ggplot(df, aes(x=q)) +
geom_density(aes(fill=resp1), alpha=0.3) +
facet_grid(agesplit ~ trial_type, scales = "free") +
theme_bw(base_size = 8) + theme(axis.title.x = element_text(size=8),
axis.title.y  = element_text(size=8)) +
scale_fill_solarized(name = "Response") +
xlab("Response time (s)") + ylab("Density of responses")
rm(list=ls())
knitr::opts_chunk$set(fig.width=3, fig.height=3, fig.crop = F, fig.pos = "tb", fig.path='figs/',
echo=F, warning=F, cache=F, message=F, sanitize = T)
library(png)
library(grid)
library(ggplot2)
library(xtable)
library(reshape)
# library(plyr)
library(lme4)
library(dplyr)
library(stringr)
library(tidyr)
# library(markdown)
library(directlabels)
library(magrittr)
# library(bootstrap)
library(RCurl)
library(langcog)
# library(RColorBrewer)
library(diptest)
library(RWiener)
# library(ppcor)
theme_set(theme_bw())
df <- read.csv("tmp.csv")
df %<>%
dplyr::mutate(age = as.numeric(age))%>%
dplyr::mutate(resp = factor(correct, levels=c("Y","N"), labels=c("upper","lower")),
q = rt/1000)%>%
dplyr::filter(selection_type != "someall", na.rm=TRUE) %>% #this is filtering out the strange repeats
dplyr::filter(selection_type != "allall", na.rm=TRUE) %>%
dplyr::filter(selection_type != "allallall", na.rm=TRUE)%>%
dplyr::filter(age <= 6.5, na.rm = TRUE)%>%
dplyr::filter(english >= 0.75, na.rm=TRUE) %>%
dplyr::mutate(age_round = round(age, digits = 2))%>%
dplyr::mutate(agesplit = cut(age_round, breaks=c(3, 3.5, 4, 4.5, 5, 6.5)),
agesplit = factor(agesplit,
labels=c("3-3.5 years", "3.5-4 years",
"4-4.5 years", "4.5-5 years",
"5+ years")))%>%
dplyr::filter(agesplit != "NA", na.rm = TRUE)
#for means
df$correct %<>%
str_replace("Y", 1)%>%
str_replace("N", 0)
df %<>%
dplyr::mutate(correct = as.numeric(correct))
#renaming for better graphs
df$trial_type %<>%
str_replace("all", "All")%>%
str_replace("some", "Some")%>%
str_replace("none", "None")
df$selection_type %<>%
str_replace("all", "All")%>%
str_replace("some", "Some")%>%
str_replace("none", "None")
x <- unique(df$sub_id)
# Exclusions
df1 <-  subset(df, sub_id != "11716_14" & sub_id != "11316_2"
& sub_id != "121815_7" & sub_id != "1616_6"
& sub_id != "TM001" & sub_id != "TM003" & sub_id != "TM004" &
sub_id != "12416_9" & sub_id!= "TM011") #excluded due to consent issue, and low number of trials, and parental interference
df <- df1
# df %<>%
#   dplyr::filter(sub_id != "11716_14" & sub_id != "11316_2" & sub_id != "12016_1"
#                 & sub_id != "12016_2" & sub_id != "12016_4" & sub_id != "12016_8"
#                 & sub_id != "12016_9" & sub_id != "11016_5" & sub_id != "11716_10"
#                 & sub_id != "1616_3" & sub_id != "11016_12" & sub_id != "121815_5"
#                 & sub_id != "121815_6" & sub_id != "121815_7" & sub_id != "1616_7"
#                 & sub_id != "12216_12" & sub_id != "12116_5" & sub_id != "12216_8")%>% # for english < 75%
#   dplyr::filter(sub_id != "1616_6", na.rm = TRUE)%>%#broken iPad
#   dplyr::filter(sub_id != "1616_4", na.rm = TRUE)%>%
#   dplyr::filter(sub_id != "TM001" & sub_id != "TM002" & sub_id != "TM003" & sub_id != "TM004" & sub_id != "TM005" & sub_id != "TM006" & sub_id != "TM007", na.rm = TRUE) #just until tamara's data is complete
#
# df %<>%
#   dplyr::filter(sub_id != "NA")%>%
#   dplyr::filter(age != "NA")
# qplot(rt, data = df)
#There are some really crazy rts - exclude everything above 30s
df$clean.rt <- df$rt
df$clean.rt[df$rt > 15000] <- NA
mlog <- mean(log(df$clean.rt), na.rm=TRUE)
sdlog <- sd(log(df$clean.rt), na.rm=TRUE)
# qplot(clean.rt, data=df)
# qplot(log(clean.rt),
#       fill = log(clean.rt) > mlog + 3*sdlog | log(clean.rt) < mlog - 3*sdlog,
#       data = df)
df$clean.rt[log(df$clean.rt) > mlog + 3*sdlog |
log(df$clean.rt) < mlog - 3*sdlog] <- NA
#filter df to exclude NAs (RT cleaned)
df %<>%
filter(clean.rt != "NA")
num_subjects <- df %>%
select(sub_id)%>%
distinct()
num_trials <- df %>%
group_by(sub_id, agesplit)%>%
summarise(n = n())
num_kids <- df %>%
dplyr::select(sub_id, agesplit) %>%
dplyr:: distinct()%>%
dplyr::group_by(agesplit)%>%
dplyr::summarize(n=n())%>%
dplyr::mutate(total.n = sum(n))
View(num_kids)
ms <- df %>%
group_by(trial_type, agesplit)%>%
multi_boot_standard("correct", na.rm=TRUE)
ms$trial_type %<>%
str_replace("all", "All")%>%
str_replace("none", "None")%>%
str_replace("some", "Some")
quartz()
ggplot(data = ms,
aes(x=trial_type, y=mean, fill= agesplit)) +
geom_bar(stat="identity", position = position_dodge()) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .4,
show.legend = FALSE,
position=position_dodge(.9)) +
ylab("Proportion correct") +
xlab("Trial Type") +
theme_bw(base_size = 8) + theme(axis.title.x = element_text(size=8),
axis.title.y  = element_text(size=8)) +
scale_fill_solarized(name = "Age") + theme(legend.position=c(.8,.8)) + theme(legend.key.size=unit(.2, "cm")) + theme(legend.title=element_text(size=5)) + theme(legend.text=element_text(size=5))
trialtypes <- c("all", "some", "none")
df$resp1 <- df$resp %>%
str_replace("lower", "Incorrect")%>%
str_replace("upper", "Correct")
#for easier to read graph
df$resp1 <- factor(df$resp1, levels=c("Incorrect", "Correct"))
quartz()
ggplot(df, aes(x=q)) +
geom_density(aes(fill=resp1), alpha=0.3) +
facet_grid(agesplit ~ trial_type, scales = "free") +
theme_bw(base_size = 8) + theme(axis.title.x = element_text(size=8),
axis.title.y  = element_text(size=8)) +
scale_fill_solarized(name = "Response") +
xlab("Response time (s)") + ylab("Density of responses")
trialtypes = c("All", "Some", "None")
#create dataframe
sub.pars <- data.frame(Separation = numeric(),
Non.Decision = numeric(),
Bias = numeric(),
Drift = numeric(),
Trial.Type = character(),
SubID = character(),
Age = character())
sub.pars$Trial.Type <- as.character(sub.pars$Trial.Type)
sub.pars$SubID <- as.character(sub.pars$SubID)
sub.pars$Age <- as.character(sub.pars$Age)
temp.pars <- sub.pars
df$resp <- as.character(df$resp)
#this takes a while to run, but estimating parameters for each subject
#Note that this is with excluded reaction time data, but it's possible that we shouldn't be excluding any rts...
# df %<>%
#   dplyr::filter(q > 0, na.rm = TRUE)
subs <- unique(df$sub_id)
for (j in 1:length(subs)) {
sid <- as.character(subs[j])
for (i in 1:length(trialtypes)) {
ttype <- as.character(trialtypes[i])
dat <- as.data.frame(subset(df, trial_type == ttype & sub_id == sid))
opt <- optim(c(1, .1, .1, 1), wiener_deviance,
dat=dplyr::select(dat, c(q, resp)), method="Nelder-Mead")
pars <- c(opt$par, ttype, sid, dat$agesplit[1])
temp.pars[i,] <- pars
}
sub.pars <- rbind(temp.pars, sub.pars)
}
sub.pars$Separation <- as.numeric(sub.pars$Separation)
sub.pars$Non.Decision <- as.numeric(sub.pars$Non.Decision)
sub.pars$Bias <- as.numeric(sub.pars$Bias)
sub.pars$Drift <- as.numeric(sub.pars$Drift)
sub.pars.ms <- sub.pars %>%
gather(Param, Value, Separation:Drift) %>%
dplyr::group_by(Age, Trial.Type, Param) %>%
multi_boot_standard("Value", na.rm = TRUE)
sub.pars.ms$Age %<>%
str_replace("1", "one")%>%
str_replace("2", "two")%>%
str_replace("3", "three")%>%
str_replace("4", "four")%>%
str_replace("5", "five")%>%
str_replace("one", "3-3.5 years") %>%
str_replace("two", "3.5-4 years")%>%
str_replace("three", "4-4.5 years")%>%
str_replace("four", "4.5-5 years")%>%
str_replace("five", "5-6.5 years")
#
quartz()
ggplot(sub.pars.ms, aes(x=Age, y=mean, color=Trial.Type)) +
geom_point(size = 1.5) + geom_linerange(aes(ymin = ci_lower, ymax = ci_upper)) +
facet_wrap(~Param, scales="free") + theme_bw(base_size = 8) + theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 7)) + langcog::scale_color_solarized(guide_legend(title="Trial Type")) + ylab("Mean") + xlab("Age")
# theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 7), axis.title.y = element_text(size=8), legend.title=element_text(size = 7), legend.text=element_text(size=6), axis.title.x = element_text(size=8), text = element_text(size = 8))
quartz()
ggplot(sub.pars.ms, aes(x=Age, y=mean, color=Trial.Type)) +
geom_point(size = 1.5) + geom_linerange(aes(ymin = ci_lower, ymax = ci_upper)) +
facet_wrap(~Param, scales="free") + theme_bw(base_size = 8) + theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 7)) + langcog::scale_color_solarized(guide_legend(title="Trial Type")) + ylab("Mean") + xlab("Age")
# theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 7), axis.title.y = element_text(size=8), legend.title=element_text(size = 7), legend.text=element_text(size=6), axis.title.x = element_text(size=8), text = element_text(size = 8))
trialtypes <- c("all", "some", "none")
df$resp1 <- df$resp %>%
str_replace("lower", "Incorrect")%>%
str_replace("upper", "Correct")
#for easier to read graph
df$resp1 <- factor(df$resp1, levels=c("Incorrect", "Correct"))
quartz()
ggplot(df, aes(x=q)) +
geom_density(aes(fill=resp1), alpha=0.3) +
facet_grid(agesplit ~ trial_type, scales = "free") +
theme_bw(base_size = 8) + theme(axis.title.x = element_text(size=8),
axis.title.y  = element_text(size=8)) +
scale_fill_solarized(name = "Response") +
xlab("Response time (s)") + ylab("Density of responses")
ms <- df %>%
group_by(trial_type, agesplit)%>%
multi_boot_standard("correct", na.rm=TRUE)
ms$trial_type %<>%
str_replace("all", "All")%>%
str_replace("none", "None")%>%
str_replace("some", "Some")
quartz()
ggplot(data = ms,
aes(x=trial_type, y=mean, fill= agesplit)) +
geom_bar(stat="identity", position = position_dodge()) +
geom_linerange(aes(ymin = ci_lower,
ymax = ci_upper),
size = .4,
show.legend = FALSE,
position=position_dodge(.9)) +
ylab("Proportion correct") +
xlab("Trial Type") +
theme_bw(base_size = 8) + theme(axis.title.x = element_text(size=8),
axis.title.y  = element_text(size=8)) +
scale_fill_solarized(name = "Age") + theme(legend.position=c(.8,.8)) + theme(legend.key.size=unit(.2, "cm")) + theme(legend.title=element_text(size=5)) + theme(legend.text=element_text(size=5))
lm <- summary(glmer(correct ~ age * trial_type +
(trial_type | sub_id),
family = "binomial", data = df))
rt_lm <- summary(lmer(log(rt) ~ scale(age, scale=FALSE) * log(trial_num) +
scale(age, scale=FALSE) * trial_type +
(trial_type | sub_id),
data = df))
# rt_lm <- summary(lmer(log(rt) ~ age * log(trial_num) +
#                age * trial_type +
#                (trial_type | sub_id),
#              data = df))
lm
diptest::dip.test(filter(ms, trial_type == "All")$mean)
ms <- df %>%
group_by(sub_id, trial_type) %>%
multi_boot_standard("correct", na.rm=TRUE)
diptest::dip.test(filter(ms, trial_type == "All")$mean)
diptest::dip.test(filter(ms, trial_type == "Some")$mean)
diptest::dip.test(filter(ms, trial_type == "None")$mean)
ms <- df %>%
group_by(sub_id, trial_type) %>%
summarise(correct = sum(correct))
ggplot(ms, aes(x = correct)) +
geom_histogram(binwidth = 1) +
facet_wrap(~trial_type)
ggplot(ms, aes(x = correct)) +
geom_histogram(binwidth = 1) +
facet_wrap(~trial_type)
quartz()
ggplot(ms, aes(x = correct)) +
geom_histogram(binwidth = 1) +
facet_wrap(~trial_type)
head(ms)
quartz()
ggplot(ms, aes(x = correct)) +
geom_histogram(binwidth = 1) + theme_bw(base_size = 8)
facet_wrap(~trial_type) + xlab("Sum of Correct Responses") + ylab("Frequency")
quartz()
ggplot(ms, aes(x = correct)) +
geom_histogram(binwidth = 1) + theme_bw(base_size = 8) + xlab("Sum of Correct Responses") + ylab("Frequency") + facet_wrap(~trial_type)
quartz()
ggplot(ms, aes(x = correct), color = trial_type) +
geom_histogram(binwidth = 1) + theme_bw(base_size = 8) + xlab("Sum of Correct Responses") + ylab("Frequency") + facet_wrap(~trial_type) + theme(legend.position="none")
quartz()
ggplot(ms, aes(x = correct), fill = trial_type, group = trial_type) +
geom_histogram(binwidth = 1) + theme_bw(base_size = 8) + xlab("Sum of Correct Responses") + ylab("Frequency") + facet_wrap(~trial_type) + theme(legend.position="none")
?ggplot
quartz()
ggplot(ms, aes(x = correct, colour=trial_type)) +
geom_histogram(binwidth = 1) + theme_bw(base_size = 8) + xlab("Sum of Correct Responses") + ylab("Frequency") + facet_wrap(~trial_type) + theme(legend.position="none")
quartz()
ggplot(ms, aes(x = correct, colour=trial_type, fill=trial_type)) +
geom_histogram(binwidth = 1) + theme_bw(base_size = 8) + xlab("Sum of Correct Responses") + ylab("Frequency") + facet_wrap(~trial_type) + theme(legend.position="none")
quartz()
ggplot(ms, aes(x = correct, colour=trial_type, fill=trial_type)) +
geom_histogram(binwidth = 1) + theme_bw(base_size = 8) + xlab("Sum of Correct Responses") + ylab("Frequency") + facet_wrap(~trial_type) + theme(legend.position="none") + langcog::scale_fill_solarized()
quartz()
ggplot(ms, aes(x = correct, fill=trial_type)) +
geom_histogram(binwidth = 1) + theme_bw(base_size = 8) + xlab("Sum of Correct Responses") + ylab("Frequency") + facet_wrap(~trial_type) + theme(legend.position="none") + langcog::scale_fill_solarized()
quartz()
ggplot(sub.pars.ms, aes(x=Age, y=mean, color=Trial.Type)) +
geom_point(size = 1.5, position=position_dodge(.9)) + geom_linerange(aes(ymin = ci_lower, ymax = ci_upper)) +
facet_wrap(~Param, scales="free") + theme_bw(base_size = 8) + theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 7)) + langcog::scale_color_solarized(guide_legend(title="Trial Type")) + ylab("Mean") + xlab("Age")
quartz()
ggplot(sub.pars.ms, aes(x=Age, y=mean, color=Trial.Type)) +
geom_point(size = 1.5, position=position_dodge(.2)) + geom_linerange(aes(ymin = ci_lower, ymax = ci_upper), position=position_dodge(.2)) +
facet_wrap(~Param, scales="free") + theme_bw(base_size = 8) + theme(axis.text.x = element_text(angle = 45, hjust = 1,size = 7)) + langcog::scale_color_solarized(guide_legend(title="Trial Type")) + ylab("Mean") + xlab("Age")
View(num_kids)
